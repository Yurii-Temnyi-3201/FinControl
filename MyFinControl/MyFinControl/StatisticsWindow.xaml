<Window x:Class="MyFinControl.StatisticsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Статистика"
        Height="500" Width="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#FFF3F4F6">

    <Window.Resources>

        <SolidColorBrush x:Key="BrushCard" Color="White"/>
        <SolidColorBrush x:Key="BrushBorder" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="BrushTextPrimary" Color="#111827"/>
        <SolidColorBrush x:Key="BrushTextSecondary" Color="#6B7280"/>
        <SolidColorBrush x:Key="BrushPositive" Color="#2563EB"/>
        <SolidColorBrush x:Key="BrushNegative" Color="#F59E0B"/>
        <LinearGradientBrush x:Key="BrushPositiveGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#2563EB" Offset="0"/>
            <GradientStop Color="#93C5FD" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="BrushNegativeGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#F59E0B" Offset="0"/>
            <GradientStop Color="#FEF3C7" Offset="1"/>
        </LinearGradientBrush>

        <Style x:Key="BaseTextBlock" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI" />
            <Setter Property="Foreground" Value="{StaticResource BrushTextPrimary}" />
            <Setter Property="TextWrapping" Value="NoWrap" />
        </Style>

        <Style x:Key="SecondaryText" TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlock}">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Foreground" Value="{StaticResource BrushTextSecondary}" />
        </Style>

        <Style x:Key="CardContainer" TargetType="Border">
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Background" Value="{StaticResource BrushCard}" />
            <Setter Property="BorderBrush" Value="{StaticResource BrushBorder}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="16" />
            <Setter Property="Margin" Value="0" />
        </Style>

    </Window.Resources>

    <Grid Margin="5,10,5,10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ВЕРХНЯ ПАНЕЛЬ: заголовок + фільтри + валюта -->
        <Grid Grid.Row="0" Margin="0,0,0,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Ліва частина -->
            <StackPanel Grid.Column="0" Orientation="Vertical">
                <TextBlock Text="Доходи та витрати за місяцями"
                       Style="{StaticResource BaseTextBlock}"
                       FontSize="14"
                       FontWeight="SemiBold" TextAlignment="Center"/>
                <TextBlock Text="(сині – доходи, жовті – витрати)"
                       Style="{StaticResource SecondaryText}" TextAlignment="Center"/>
            </StackPanel>

            <!-- Права частина: Рік – Місяць – Валюта -->
            <StackPanel Grid.Column="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center">

                <!-- Рік -->
                <TextBlock Text="Рік:"
                       Style="{StaticResource SecondaryText}"
                       Margin="0,0,4,0"/>
                <ComboBox x:Name="YearComboBox"
                      Width="80"
                      Height="22"
                      Margin="0,0,12,0"
                      SelectionChanged="Filter_Changed"/>

                <!-- Місяць -->
                <TextBlock Text="Місяць:"
                       Style="{StaticResource SecondaryText}"
                       Margin="0,0,4,0"/>
                <ComboBox x:Name="MonthComboBox"
                      Width="120"
                      Height="22"
                      Margin="0,0,12,0"
                      SelectionChanged="Filter_Changed">
                    <ComboBoxItem Content="Увесь рік" Tag="{x:Null}" IsSelected="True"/>
                    <ComboBoxItem Content="Січень" Tag="1"/>
                    <ComboBoxItem Content="Лютий" Tag="2"/>
                    <ComboBoxItem Content="Березень" Tag="3"/>
                    <ComboBoxItem Content="Квітень" Tag="4"/>
                    <ComboBoxItem Content="Травень" Tag="5"/>
                    <ComboBoxItem Content="Червень" Tag="6"/>
                    <ComboBoxItem Content="Липень" Tag="7"/>
                    <ComboBoxItem Content="Серпень" Tag="8"/>
                    <ComboBoxItem Content="Вересень" Tag="9"/>
                    <ComboBoxItem Content="Жовтень" Tag="10"/>
                    <ComboBoxItem Content="Листопад" Tag="11"/>
                    <ComboBoxItem Content="Грудень" Tag="12"/>
                </ComboBox>

                <!-- Валюта -->
                <TextBlock Text="Валюта:"
                       Style="{StaticResource SecondaryText}"
                       Margin="0,0,4,0"/>
                <ComboBox x:Name="CurrencyComboBox"
                      Width="76"
                      Height="22"
                      SelectionChanged="CurrencyComboBox_SelectionChanged">
                    <ComboBoxItem Content="UAH" IsSelected="True"/>
                    <ComboBoxItem Content="USD"/>
                    <ComboBoxItem Content="EUR"/>
                </ComboBox>
            </StackPanel>
        </Grid>

        <!-- КАРТКА З ДІАГРАМОЮ -->
        <Border Grid.Row="1" Style="{StaticResource CardContainer}">
            <!-- ДІАГРАМА (вертикальні стовпчики доходів/витрат) -->
            <ScrollViewer x:Name="ChartArea"
                          Margin="0,4,0,0"
                      Padding="16,4,16,16"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Disabled">
                <ItemsControl ItemsSource="{Binding Stats}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="0,0,24,0" VerticalAlignment="Bottom">

                                <!-- Назва місяця -->
                                <TextBlock Text="{Binding Label}"
                                       Style="{StaticResource SecondaryText}"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,8"/>

                                <!-- Контейнер двох вертикальних стовпців -->
                                <Grid Width="72" HorizontalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <!-- Доходи -->
                                    <StackPanel Grid.Column="0" VerticalAlignment="Bottom">
                                        <TextBlock Text="{Binding Income, StringFormat=\{0:F0\}}"
                   Foreground="{StaticResource BrushPositive}"
                   FontSize="12"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,6"/>
                                        <Border Height="{Binding IncomePercent}"
                Width="18"
                CornerRadius="4"
                HorizontalAlignment="Center"
                Background="{StaticResource BrushPositiveGradient}"/>
                                    </StackPanel>

                                    <!-- Витрати -->
                                    <StackPanel Grid.Column="1" VerticalAlignment="Bottom">
                                        <TextBlock Text="{Binding Expense, StringFormat=\{0:F0\}}"
                   Foreground="{StaticResource BrushNegative}"
                   FontSize="11"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,6"/>
                                        <Border Height="{Binding ExpensePercent}"
                Width="18"
                CornerRadius="4"
                HorizontalAlignment="Center"
                Background="{StaticResource BrushNegativeGradient}"/>
                                    </StackPanel>
                                </Grid>

                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>
    </Grid>

</Window>
